<!DOCTYPE html>
<html>
  <head>
    <script src="./compiler.js"></script>
    <script src="./r3www.js"></script>    

<script>
function r3Compile() { r3token(document.getElementById("srccode").value); }
function dumpVM() {
	const setDiv = (id, value) => document.getElementById(id).innerText = value;
      setDiv("ip", ip);
      setDiv("ds", [TOS, ...(dpila.slice(2, NOS+1).reverse())].join(" "));
      setDiv("cs", rpila.slice(1, RTOS+1).join(" "));
      setDiv("mc", memcode.slice(0,memc).join(" "));
      //setDiv("md", mem.slice(0,memd).join(","));
	  setDiv("dic",dicc.join(","));
    }
	
</script>

<style>	
table td, table td * { vertical-align: top; }	
</style>

  </head>
  <body>
r3 personal computer | 
NONAME |
<button onclick="">Load</button>
<button onclick="">Save</button>
<button onclick="">Copy</button>
 <br>
	<table><tr><td>

<textarea id="srccode" rows="10">| comentario
:cua dup * ;
5 cua ;
</textarea><br>
<button onclick="r3Compile();dumpVM();">Comp</button>    
<button onclick="r3step();dumpVM();">Step</button>
<button onclick="r3run();dumpVM();">Run</button><br>
<button onclick="r3Compile();r3run();dumpVM();">Comp+Run</button>
<br><br>
<!--
<input type="text" value=""><br>
<button onclick="r3run();dumpVM();">Run</button><br>
-->
	</td><td>
<canvas id="ex1" width="512" height="512" style="border:1px solid #000000;"></canvas>
	</td><td>
DATA STACK:<div id="ds"></div><br>
CODE STACK:<div id="cs"></div><br>
IP:<div id="ip"></div><br>    
MEMCODE:<div id="mc"></div><br>
MEMDATA:<div id="md"></div><br>
DICC:<div id="dic"></div><br>
ERR:<div id=""logerror"></div><br>
</td></tr>
	
	</table>
<script>	

function animate() {
reqAnimFrame = window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;
reqAnimFrame(animate);

draw();
}

var canvas  = document.getElementById("ex1");
var context = canvas.getContext("2d"); // alpha:false;
var imageData = context.createImageData(512,512);


function draw() {
var pixelIndex=513*4;
imageData.data[pixelIndex    ] = 0;  // red   color
imageData.data[pixelIndex + 1] =   0;  // green color
imageData.data[pixelIndex + 2] =   0;  // blue  color
imageData.data[pixelIndex + 3] = 255;	
pixelIndex=1026*4;
imageData.data[pixelIndex    ] = 0;  // red   color
imageData.data[pixelIndex + 1] =   0;  // green color
imageData.data[pixelIndex + 2] =   0;  // blue  color
imageData.data[pixelIndex + 3] = 255;	
	
context.putImageData(imageData,0,0);
}

animate();
</script>

  </body>
</html>